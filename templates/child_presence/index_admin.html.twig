{% extends 'base_admin.html.twig' %}

{% block title %}ChildPresence index{% endblock %}

{% block body %}
    <p></p>
    <h1>ChildPresence index</h1>

    <table class="table">
        <thead>
    <tr>  
        <th>Enfants</th>
        <th>Status</th> <!-- Nouvelle colonne pour l'ic√¥ne -->
        <th>Pr√©sent</th>
        <th>Arriv√©e</th>
        <th>D√©part</th>
        <th>Action D√©part</th> <!-- Nouvelle colonne -->
        <th>Note</th>
        <th>Actions</th>
    </tr>
</thead>
<tbody>
            {% for child in children %}
                {% set child_presence = presenceMap[child.id] ?? null %}
                <tr data-child-id="{{ child.id }}">
                    <td>{{ child.firstName }} {{ child.lastName }}</td>
                    <td class="status-cell">
                        {% if child_presence %}üü¢{% else %}üî¥{% endif %}
                    </td>
                    <td class="presence-cell">
                        {% if not child_presence %}
                            <button class="btn btn-sm btn-success mark-arrival-btn" 
                                    data-id="{{ child.id }}">
                                Pr√©sent
                            </button>
                        {% else %}
                            Oui
                        {% endif %}
                    </td>
                    <td class="arrival-time">
                        {% if child_presence and child_presence.arrivalTime %}
                            {{ child_presence.arrivalTime|date('H:i') }}
                        {% endif %}
                    </td>
                    <td class="departure-time">
                        {% if child_presence and child_presence.departureTime %}
                            {{ child_presence.departureTime|date('H:i') }}
                        {% endif %}
                    </td>
                    <td class="departure-action">
                        {% if child_presence and child_presence.arrivalTime and not child_presence.departureTime %}
                            <button class="btn btn-sm btn-warning mark-departure-btn" 
                                    data-id="{{ child_presence.id }}">
                                D√©part
                            </button>
                        {% elseif child_presence and child_presence.departureTime %}
                            ‚úîÔ∏è
                        {% endif %}
                    </td>
                    <td>
                        {{ child_presence ? child_presence.note : '' }}
                    </td>
                    <td class="actions-cell">
                        {% if child_presence %}
                            <a href="{{ path('app_child_presence_show', {'id': child_presence.id}) }}">voir</a>
                            <a href="{{ path('app_child_presence_edit', {'id': child_presence.id}) }}">modifier</a>
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
    
        </tbody>

    </table>
    <button id="refreshPresences">üîÅ Recharger les pr√©sences</button>
    <a href="{{ path('app_child_presence_new') }}">Create new</a>
{% endblock %}